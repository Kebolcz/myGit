<style>
    .vitem {
        clear: both;
        width: 100%;
        position: relative;
        background-color: #ffffff;
    }
    .vitem img {
        display: block;
        margin: 0 auto;
    }
</style>

<div class="ub ub-ac ub-pc uc-bf vitem">
    <div id="btnStartVoice" onclick="initRecognizer()">
        <img src="../css/img/yu.jpg" style="height:3.125em;" id="imgv"/>
    </div>
</div>
<script type="text/javascript">
    // 获取系统平台
    var winPlat = window.navigator.platform;
    // 判断是否为手机(相对于模拟器)
    var isPhone = !(winPlat == 'Win32' || winPlat == 'Win64' || winPlat == 'MacIntel' || winPlat == 'Linux i686' || winPlat == 'Linux x86_64');

    // 操作系统是否为安卓
    var isAndroid = (window.navigator.userAgent.indexOf('Android') >= 0) ? true : false;

    // 操作系统是否为IOS
    var isIOS = (winPlat == 'iPad' || winPlat == 'iPod' || winPlat == 'iPhone');

    //var appID_IOS = "57de2670";
    //var appID_Android = "57de264c";
    //语音识别插件应用ID,讯飞官网分苹果和安卓两种应用分别申请;
    //此处默认ios应用的appID

    function vinit() {
        var appID = '57de2670';
        if (isAndroid) {
            appID = "57de264c";
        }
        var params = {
            appID : appID
        };
        var data = JSON.stringify(params);
        uexXunfei.init(data);
    }

    function cbInit(info) {
        info = JSON.parse(info);
    }

    function initRecognizer() {
        var initInfo;
        if (location.href.indexOf('http') == 0) {
            //调试模式
            initInfo = '{"result":"ok"}';
        } else {
            initInfo = appcan.getLocVal("uexXunfei.cbInit");
        }
        if (initInfo) {
            try {
                initInfo = JSON.parse(initInfo);
            } catch(e) {
                appcan.logs(e.message);
            }
            if (initInfo["result"]) {
                var params = {};
                var data = JSON.stringify(params);
                uexXunfei.initRecognizer(data);
                startListening();
            } else {
                //提醒语音插件初始化失败

            }
        }
    }

    function startListening() {
        var params = {};
        var data = JSON.stringify(params);
        uexXunfei.startListening(data);
    }

    function onRecognizeError(info) {
        //alert('onRecognizeError: ' + info);
        $("#lblListeningError").html('onRecognizeError: ' + info);
    }

    function onBeginOfSpeech(info) {
        $("#imgv").attr("src", "../css/img/yuyining.gif");
        //$("#content span").html("");
        //alert('onBeginOfSpeech: ' + info);
        //$("#lblListeningBegin").html('onBeginOfSpeech: ' + info);
    }

    function onEndOfSpeech(info) {
        $("#imgv").attr("src", "../css/img/yu.jpg");
        //alert('onEndOfSpeech: ' + info);
        $("#lblListeningEnd").html('onEndOfSpeech: ' + info);
    }

    function onRecognizeResult(info) {
        var vtxtID = appcan.getLocVal("voiceInputID");
        var vtxtVal= $("#"+vtxtID).val();
        vtxtVal += info;
        $("#" + vtxtID).val(vtxtVal.replace("undefined",""));
    }
</script>